// PAGE PRODUCTS
const pageProducts = [
    {   
        id: 0,
        img: 'https://cdn.shopify.com/s/files/1/0251/2155/4510/products/7652p_262c_1x_e931ecde-ec21-47ef-96eb-8424c3913890_800x.jpg?v=1608318433',
        name: '[KHAI TRƯƠNG 149K-219K] Chuỗi Balo, Túi xách Minecraft được giảm giá đặc biệt nhân ngày mở bán',
        oldPrice: '1.500.000đ',
        curPrice: '1.200.000đ',
        sold: 12,
        brand: 'Minecraft',
        origin: 'American',
        react: 'Yêu thích',
        per: 23,
        label: 'GIẢM',
        link: 'product-info.html',
        liked: '2,1',
        rev: 78, 
        oldPriceInfo: '₫220.000 - ₫396.000',
        curPriceInfo: '₫149.000 - ₫219.000',
        available: 1100,
        owner: 'toykids',
        revTotal: 220,
        resRate: 95,
        join: 6,
        proQnt: 14,
        resTime: 'trong vài phút',
        follower: '2,3',
        material: 'Vải',
        from: 'Quận Hoàng Mai, Hà Nội',
        depot: 1099
    },
    {   
        id: 0,
        img: 'https://cdn.shopify.com/s/files/1/0251/2155/4510/products/9283p_28c_2x_9cc4830c-d6c2-43f8-b3dd-10fb4081fcd2_800x.jpg?v=1607528622',
        name: 'Bộ ghim cừu Minecraft MINECON Earth 2018',
        oldPrice: '2.500.000đ',
        curPrice: '300.000đ',
        sold: 33,
        brand: 'Minecraft',
        origin: 'American',
        react: 'Yêu thích',
        per: 33,
        label: 'GIẢM',
        link: 'product-info.html'
    },
    {   
        id: 0,
        img: 'https://cdn.shopify.com/s/files/1/0251/2155/4510/products/11146p_99c_1x_cd2633cf-fc5d-40b4-8f73-1e7bc1535188_800x.jpg?v=1611763680',
        name: 'Lô gấu bông Minecraft Dungeons Mini',
        oldPrice: '500.000đ',
        curPrice: '250.000đ',
        sold: 11,
        brand: 'Minecraft',
        origin: 'American',
        react: 'Yêu thích',
        per: 12,
        label: 'GIẢM',
        link: 'product-info.html'
    },
    {   
        id: 0,
        img: 'https://cdn.shopify.com/s/files/1/0251/2155/4510/products/8316p_99c_1x_4317c0a9-8c2d-4f38-9a2d-61e03c14001b_800x.jpg?v=1607458896',
        name: 'Trọn bộ Stiker Minecraft Education Edition',
        oldPrice: '300.000đ',
        curPrice: '150.000đ',
        sold: 112,
        brand: 'Minecraft',
        origin: 'American',
        react: 'Yêu thích',
        per: 71,
        label: 'GIẢM',
        link: 'product-info.html'
    },
    {   
        id: 0,
        img: 'https://cdn.shopify.com/s/files/1/0251/2155/4510/products/3942p_21c_1x_3c19c696-c546-4248-814a-042ebdb0df20_800x.jpg?v=1610059305',
        name: 'Áo thun cao cấp tượng Minecraft',
        oldPrice: '690.000đ',
        curPrice: '250.000đ',
        sold: 13,
        brand: 'Minecraft',
        origin: 'American',
        react: 'Yêu thích',
        per: 61,
        label: 'GIẢM',
        link: 'product-info.html'
    },{   
        id: 0,
        img: 'https://cdn.shopify.com/s/files/1/0251/2155/4510/products/7711p_99c_4x_768bb411-b608-4c24-b20a-5bbf6bb9f237_800x.jpg?v=1611172100',
        name: 'Ly gốm sứ Minecraft Zombie',
        oldPrice: '570.000đ',
        curPrice: '350.000đ',
        sold: 13,
        brand: 'Minecraft',
        origin: 'American',
        react: 'Yêu thích',
        per: 11,
        label: 'GIẢM',
        link: 'product-info.html'
    },
    {   
        id: 0,
        img: 'https://cdn.shopify.com/s/files/1/0251/2155/4510/products/10758p_99c_1x_800c358a-9c22-4488-9565-93668c38053e_800x.jpg?v=1610399275',
        name: 'Móc khóa lợn bám bùn Minecraft Earth',
        oldPrice: '30.000đ',
        curPrice: '12.000đ',
        sold: 141,
        brand: 'Minecraft',
        origin: 'American',
        react: 'Yêu thích',
        per: 16,
        label: 'GIẢM',
        link: 'product-info.html'
    },
    {   
        id: 0,
        img: 'https://cdn.shopify.com/s/files/1/0251/2155/4510/products/9489p_28c_2x_847989c3-a873-4f92-9abd-a39503228363_800x.jpg?v=1610059374',
        name: 'Hộp ăn trưa gia đình Miner',
        oldPrice: '950.000đ',
        curPrice: '720.000đ',
        sold: 9,
        brand: 'Minecraft',
        origin: 'American',
        react: 'Yêu thích',
        per: 5,
        label: 'GIẢM',
        link: 'product-info.html'
    },
    {   
        id: 0,
        img: 'https://cdn.shopify.com/s/files/1/0251/2155/4510/products/6627p_13c_1x_93708f07-c3e6-424d-a218-ebb96fc2dc20_800x.jpg?v=1610059296',
        name: 'Thắt lưng Creeper Minecraft',
        oldPrice: '350.000đ',
        curPrice: '129.000đ',
        sold: 2,
        brand: 'Minecraft',
        origin: 'American',
        react: 'Yêu thích',
        per: 65,
        label: 'GIẢM',
        link: 'product-info.html'
    },
    {   
        id: 0,
        img: 'https://cdn.shopify.com/s/files/1/0251/2155/4510/products/10371p_99c_2x_06035991-bd12-4846-a531-fcfe22c50d62_800x.jpg?v=1610399275',
        name: 'Móc khóa Steve trở về từ địa ngục',
        oldPrice: '30.000đ',
        curPrice: '19.000đ',
        sold: 122,
        brand: 'Minecraft',
        origin: 'American',
        react: 'Yêu thích',
        per: 70,
        label: 'GIẢM',
        link: 'product-info.html'
    }
] // save page products info

// handle and render products
function renderPageProducts() {
    let productElsCtn = document.querySelector('.home-product .row'); // get element of product container
    let productEls = ''; // save page products 

    for (let pageProduct of pageProducts) {
        productEls += 
        `<div class="col l-2-4 m-4 c-6">
            <a href="product-info.html" id="${pageProduct.id}" class="home-product-item">
                <img src=" ${pageProduct.img}" class="home-product-item__img">
                <div class="home-product-item__name"> ${pageProduct.name} </div>
                <div class="home-product-item__price">
                    <span class="home-product-item__price-old"> ${pageProduct.oldPrice} </span>
                    <span class="home-product-item__price-current"> ${pageProduct.curPrice} </span>
                </div>
                <div class="home-product-item__action">
                    <span class="home-product-item__like home-product-item__like--liked">
                        <i class="home-product-item__like-icon-empty far fa-heart"></i>
                        <i class="home-product-item__like-icon-fill fas fa-heart"></i>
                    </span>
                    <div class="home-product-item__rating">
                        <i class="home-product-item__star--gold fas fa-star"></i>
                        <i class="home-product-item__star--gold fas fa-star"></i>
                        <i class="home-product-item__star--gold fas fa-star"></i>
                        <i class="home-product-item__star--gold fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <span class="home-product-item__sold"> ${pageProduct.sold + ' đã bán'} </span>
                </div>
                <div class="home-product-item__origin">
                    <span class="home-product-item__brand"> ${pageProduct.brand} </span>
                    <span class="home-product-item__origin-name"> ${pageProduct.origin} </span>
                </div>
                <div class="product-favourite">
                    <i class="fas fa-check"></i>
                    <span> ${pageProduct.react} </span>
                </div>
                <div class="product-sale-off">
                    <span class="product-sale-off__percent"> ${pageProduct.per}% </span>
                    <span class="product-sale-off__label"> ${pageProduct.label} </span>
                </div>
            </a>
        </div>`
    }
    
    if (productElsCtn) {
        productElsCtn.innerHTML = productEls;
    }
}

renderPageProducts();

// sort price
function sortPrice() {
    let firstSelection = document.querySelector('.select-input__list > li:first-child'); // get the element of the low to high sort button 
    let lastSelection = document.querySelector('.select-input__list > li:last-child'); // get the element of the high to low sort button

    // Remove dots and convert to numbers from price
    function fixPrice(num) {
        return Number.parseInt(num.replace(/[\.]/g, ''));
    }

    // Sort from low to high
    if (firstSelection) {
        firstSelection.onclick = () => {
            pageProducts.sort((a, b) => {
                a = fixPrice(a.curPrice);
                b = fixPrice(b.curPrice);
                return a - b;
            })
            renderPageProducts();
        }
    }

    // Sort from high to low
    if (lastSelection) {
        lastSelection.onclick = () => {
            pageProducts.sort((a, b) => {
                a = fixPrice(a.curPrice);
                b = fixPrice(b.curPrice);
                return b - a;
            })
            renderPageProducts();
        }
    }
}

sortPrice();

// sort products
function sortProducts() {
    let btnClassList = document.getElementsByClassName('home-filter__btn'); // get button class list
    let cmBtn = btnClassList[0]; // get element of the common button
    let newBtn = btnClassList[1]; // get element of the newest button
    let sellBtn = btnClassList[2]; // get element of best-selling button

    // remove background class of button
    function removeBgrClass() {
        for (let el of btnClassList) {
            el.classList.remove('btn--primary');
        }
    }

    if (cmBtn) {
        cmBtn.onclick = () => {
            removeBgrClass();
            cmBtn.classList.add('btn--primary');
            pageProducts.sort((a, b) => {
                return b.sold - a.sold;
            })
            renderPageProducts();
        }
    }

    if (newBtn) {
        newBtn.onclick = () => {
            location.reload();
        }
    }
    
    if (sellBtn) {
        sellBtn.onclick = () => {
            removeBgrClass();
            sellBtn.classList.add('btn--primary');
            pageProducts.sort((a, b) => {
                return b.sold - a.sold;
            })
            renderPageProducts();
        }
    }
}

sortProducts();

// CATEGORY ITEMS
// handle and render category items
function renderCgrItems() {
    const cgrItems = [
        {
            name: 'Sản phẩm',
            link: '#',
            active: true
        },
        {
            name: 'Deal hot',
            link: '#',
            active: false
        },
        {
            name: 'Top bán chạy',
            link: '#',
            active: false
        },
        {
            name: 'Hàng mới',
            link: '#',
            active: false
        },
        {
            name: 'Sản phẩm Hot',
            link: '#',
            active: false
        },
        {
            name: 'Phụ kiện',
            link: '#',
            active: false
        },
        {
            name: 'Tai nghe',
            link: '#',
            active: false
        },
        {
            name: 'Pin sạc dự phòng',
            link: '#',
            active: false
        },
        {
            name: 'Áo quần',
            link: '#',
            active: false
        },
        {
            name: 'Hàng khuyến mãi',
            link: '#',
            active: false
        }
    ] // save category items info
    
    let cgrElsCtn = document.querySelector('.category-pc .category-list'); // get element of category list
    let cgrEls = ''; // save category items

    for (let cgrItem of cgrItems) {
        if (cgrItem.active === true) {
            cgrEls +=
                `<li class="category-item category-item--active">
                    <div class="category-item__icon">
                        <i class="fas fa-caret-right"></i>
                    </div>
                    <a href="${cgrItem.link}" class="category-item__link">${cgrItem.name}</a>
                </li>`
        } else {
            cgrEls +=
                `<li class="category-item">
                    <div class="category-item__icon">
                        <i class="fas fa-caret-right"></i>
                    </div>
                    <a href="${cgrItem.link}" class="category-item__link">${cgrItem.name}</a>
                </li>`
        }
    }
    
    cgrElsCtn.innerHTML = cgrEls;
}

renderCgrItems();

// handle event when the user hovers the category item
function hoverCategoryItems() {
    let cgrElIdx = -1; // initialize the ordinal numbers of category items
    let actEl = 'category-item--active'; // set active property of item
    
    let cgrPC_Ctn = document.querySelector('.category-pc > .category'); // get element of category container on PC
    let cgrElsCtn = cgrPC_Ctn.querySelector('.category-list'); // get element of category list
    let cgrEls = cgrElsCtn.querySelectorAll('.category-item'); // get element of category items

    // remove active property of item 
    let removeColor = () => {
        for (let cgrEl of cgrEls) {
            if (cgrEl.classList.contains(actEl)) {
                cgrEl.classList.remove(actEl);
            }
        }
    }

    // handle hover
    for (let cgrEl of cgrEls) {
        cgrEl.onmouseover = () => {                                                                                                                                               
            removeColor();
            cgrEl.classList.add(actEl);
        }
    }

    // loop through all items until reach the active item
    for (let cgrEl of cgrEls) {
        cgrElIdx++;
        if (cgrEl.classList.contains(actEl)) {
            break;
        }
    }

    // when hovering out container will reset the original active state
    cgrElsCtn.onmouseleave = () => {
        let cgrActChild = cgrElsCtn.children[cgrElIdx]; // get element of original active item
        
        removeColor();
        cgrActChild.classList.add(actEl);
    }
}

hoverCategoryItems();